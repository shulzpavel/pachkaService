# =============================================================================
# Pachka Service - Environment Configuration
# =============================================================================
# Скопируй этот файл в .env и заполни реальными значениями
# cp env.example .env
# =============================================================================

# -----------------------------------------------------------------------------
# Pachka API (ОБЯЗАТЕЛЬНО)
# -----------------------------------------------------------------------------
# Токен бота получается в Пачке: Автоматизации → API
PACHKA_TOKEN=<fill-me>

# User ID бота (для добавления бота в чаты через API)
# Находится в настройках интеграции вместе с токеном
PACHKA_BOT_USER_ID=<fill-me>

# Базовый URL API Пачки (обычно не меняется)
PACHKA_API_BASE=https://api.pachca.com/api/shared/v1

# -----------------------------------------------------------------------------
# Jira Configuration
# -----------------------------------------------------------------------------
# Базовый URL Jira для формирования ссылок на задачи в шаблонах
# Пример: https://your-company.atlassian.net
JIRA_BASE_URL=https://your-company.atlassian.net

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
# Порт для Gateway сервиса (по умолчанию: 3000)
PORT=3000

# Окружение (production для продакшена)
NODE_ENV=production

# Уровень логирования (debug, info, warn, error)
LOG_LEVEL=info

# Путь к файлу логов (опционально)
# LOG_FILE=/var/log/jira-pachka-router.log

# -----------------------------------------------------------------------------
# Service URLs (для Docker используются имена сервисов)
# -----------------------------------------------------------------------------
# URL Router Service (в Docker: http://router:3001)
ROUTER_SERVICE_URL=http://router:3001

# URL Notifier Service (в Docker: http://notifier:3002)
NOTIFIER_SERVICE_URL=http://notifier:3002

# -----------------------------------------------------------------------------
# Jira Webhook Security (РЕКОМЕНДУЕТСЯ для production)
# -----------------------------------------------------------------------------
# HMAC секрет для проверки подписи webhook от Jira
# Настрой в Jira webhook заголовок X-Jira-Webhook-Signature
# JIRA_WEBHOOK_SECRET=your_shared_secret_for_hmac_verification

# IP allowlist для Jira (через запятую, CIDR нотация)
# Пример: JIRA_ALLOWED_IPS=192.168.1.1,10.0.0.0/8,172.16.0.0/12
# Оставь пустым для отключения IP блокировки
# JIRA_ALLOWED_IPS=

# Доверенные прокси (IP адреса reverse proxy, через запятую)
# Если используешь nginx/traefik перед gateway, укажи их IP
TRUSTED_PROXIES=127.0.0.1,::1

# -----------------------------------------------------------------------------
# Internal Services Security (РЕКОМЕНДУЕТСЯ для production)
# -----------------------------------------------------------------------------
# IP allowlist для доступа к router/notifier (только для внутренней сети)
# В Docker используй имена сервисов: gateway,127.0.0.1,::1
# Оставь пустым для отключения IP блокировки
# INTERNAL_ALLOWED_IPS=gateway,127.0.0.1,::1

# -----------------------------------------------------------------------------
# Admin API (РЕКОМЕНДУЕТСЯ для production)
# -----------------------------------------------------------------------------
# API ключ для административных endpoints (/reload)
# Если не указан в production - endpoint отключен (404)
# Использование: X-Admin-API-Key: your_admin_key
ADMIN_API_KEY=<fill-me>

# =============================================================================
# ПРИМЕЧАНИЯ:
# =============================================================================
# 1. НЕ коммить .env файл в Git (он уже в .gitignore)
# 2. Для production обязательно настрой:
#    - PACHKA_TOKEN и PACHKA_BOT_USER_ID
#    - JIRA_WEBHOOK_SECRET (рекомендуется)
#    - JIRA_ALLOWED_IPS (рекомендуется)
#    - ADMIN_API_KEY (рекомендуется)
# 3. IP allowlist можно отключить, оставив переменные пустыми
# 4. Все секреты храни только в .env, не в docker-compose.yml
# =============================================================================
